# Amazon Bedrock Agent Core Runtime Example with STRANDS Framework

This example demonstrates how to create an Amazon Bedrock Agent Core Runtime using the Terraform AWS Bedrock module and the STRANDS framework.

## Overview

This example demonstrates how to create an Amazon Bedrock Agent Core Runtime using the Terraform AWS Bedrock module. The example includes:

1. Creating an ECR repository for the agent runtime container
2. Automatically building and pushing a Docker image to the ECR repository
3. Creating a Bedrock Agent Runtime using the Docker image
4. Creating a Bedrock Agent Runtime Endpoint
5. Implementing a STRANDS framework agent with tool-calling capabilities

### Agent Runtime Implementation

The example includes a comprehensive implementation of an agent runtime using the STRANDS framework:

- `Dockerfile`: A Python 3.11 Dockerfile for the agent runtime
- `app.py`: A STRANDS framework implementation with BedrockAgentCoreApp integration
- `requirements.txt`: Python dependencies including STRANDS and Bedrock Agent Core libraries
- `test_agent.py`: A testing script for local agent testing
- `invoke_runtime.py`: A client script for testing the deployed runtime

The agent implementation includes several tools:
- Calculator tool for mathematical operations
- Weather tool for providing weather information
- Greeting tool for personalized greetings

The agent uses Claude 3.7 Sonnet as the underlying model and is configured with the BedrockAgentCoreApp framework to handle the HTTP server functionality automatically.

### How It Works

The example uses a `null_resource` with a `local-exec` provisioner to:

1. Authenticate to ECR
2. Build the Docker image from the provided files
3. Push the image to the ECR repository

The Bedrock Agent Runtime is then created with a dependency on the Docker image, ensuring that the image is available before the runtime is created.

### Testing the Agent

The example includes two testing scripts:

#### Local Testing with test_agent.py

This script allows you to test the agent locally without deploying to AWS:

```bash
# Run unit tests
python test_agent.py

# Run in interactive mode
python test_agent.py --interactive
```

The unit tests verify the agent's ability to:
- Perform mathematical calculations
- Provide weather information
- Generate personalized greetings

#### Deployed Runtime Testing with invoke_runtime.py

After deploying the runtime using Terraform, you can test it with:

```bash
# Check runtime status and invoke with default prompt
python invoke_runtime.py --runtime-arn <your-runtime-arn> --qualifier <endpoint-qualifier>

# Only check runtime status
python invoke_runtime.py --runtime-id <your-runtime-id> --status-only

# Test with a specific prompt
python invoke_runtime.py --runtime-arn <your-runtime-arn> --qualifier <endpoint-qualifier> --prompt "What's the weather like?"
```

### Prerequisites

To run this example, you need:

1. Docker installed and running on your machine
2. AWS CLI configured with appropriate permissions
3. Terraform installed
4. Python 3.11 or later (for local testing)
5. Required Python packages: strands-agents, strands-agents-tools, bedrock-agentcore

### Customizing the Agent Runtime

If you want to customize the agent runtime:

1. Modify the `app.py` file to implement your custom logic:
   - Add new tools by creating functions with the `@tool` decorator
   - Adjust the system prompt to reflect new capabilities
   - Modify the model parameters for different behavior

2. Update the `requirements.txt` file if you need additional dependencies

3. Adjust the `Dockerfile` if necessary

4. Update the testing scripts to test your new functionality

The Docker image will be automatically rebuilt and pushed when you apply the Terraform configuration again.
