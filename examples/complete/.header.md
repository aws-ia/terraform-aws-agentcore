# Complete Example

This example demonstrates all AgentCore resources working together:

- **2 Runtimes**: CODE (Python) + CONTAINER (Docker with STRANDS)
- **Memory**: With 3 built-in strategies (semantic, summary, user preference)
- **Gateway**: MCP protocol gateway
- **Gateway Target**: Lambda function integration
- **Browser**: Custom browser (recording disabled)
- **Code Interpreter**: Secure Python execution

**⚠️ ARM64 Requirement**: Both CODE and CONTAINER runtimes require ARM64 architecture. The module automatically handles this via CodeBuild.

## Usage

```bash
terraform init
terraform plan
terraform apply
```

## Auto-Generated Files

Terraform creates files in the `autogen/` directory:
- `autogen/.env` - Environment variables with actual AWS resource IDs
- `autogen/test_*.sh` - Test scripts for each runtime
- `autogen/lambda.zip` - Lambda deployment package

**Note:** The `autogen/` directory is gitignored and safe to delete.

## What Gets Created

- 2 AgentCore runtimes with endpoints (both update in-place with zero downtime)
- 1 Memory resource with 3 strategies
- 1 Gateway with MCP protocol
- 1 Gateway target pointing to Lambda
- 1 Custom browser (recording disabled)
- 1 Code interpreter in sandbox mode
- Lambda function for gateway target
- S3 buckets for CODE runtime
- ECR repository + CodeBuild (ARM64) for CONTAINER runtime
- IAM roles for all resources

## Testing

**Preferred: AWS Console** - Navigate to [Amazon Bedrock > AgentCore > Test](https://console.aws.amazon.com/bedrock-agentcore/playground) and use the Agent sandbox UI.

Or use the generated test scripts:

```bash
./autogen/test_python_agent.sh "Hello world"
./autogen/test_container_agent.sh "What can you do?"
```

Or invoke directly with AWS CLI:

```bash
aws bedrock-agent-runtime invoke-agent \
  --agent-runtime-id <runtime-id> \
  --input-text "Hello" \
  --region us-east-1
```

## Code Updates

Both runtimes support zero-downtime updates:

```bash
# Edit code
vim ../basic-code-runtime/src/agent.py
vim ../basic-container-runtime/src/app.py

# Apply - updates in-place
terraform apply
```
